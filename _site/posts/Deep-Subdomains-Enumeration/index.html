<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Deep-Subdomains-Enumeration" /><meta name="author" content="h0tak88r" /><meta property="og:locale" content="en" /><meta name="description" content="What’s the need?" /><meta property="og:description" content="What’s the need?" /><link rel="canonical" href="h0tak88r.github.com/posts/Deep-Subdomains-Enumeration/" /><meta property="og:url" content="h0tak88r.github.com/posts/Deep-Subdomains-Enumeration/" /><meta property="og:site_name" content="hotak88r" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-06-05T00:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Deep-Subdomains-Enumeration" /><meta name="twitter:site" content="@h0tak88r" /><meta name="twitter:creator" content="@h0tak88r" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"h0tak88r"},"dateModified":"2023-06-05T00:00:00+03:00","datePublished":"2023-06-05T00:00:00+03:00","description":"What’s the need?","headline":"Deep-Subdomains-Enumeration","mainEntityOfPage":{"@type":"WebPage","@id":"h0tak88r.github.com/posts/Deep-Subdomains-Enumeration/"},"url":"h0tak88r.github.com/posts/Deep-Subdomains-Enumeration/"}</script><title>Deep-Subdomains-Enumeration | hotak88r</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="hotak88r"><meta name="application-name" content="hotak88r"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="https://firebasestorage.googleapis.com/v0/b/images-directory.appspot.com/o/avatar.jpg?alt=media&token=2dee9c80-7623-4c57-b93d-a908d8594ef5" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">hotak88r</a></div><div class="site-subtitle fst-italic">Penetration Testing Student | Computer Engineering Student @ohi | Bug Hunter @bugcrowd</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/h0tak88r" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/h0tak88r" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['h0tak88r','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Deep-Subdomains-Enumeration</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>Deep-Subdomains-Enumeration</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1685912400" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 5, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1392 words" > <em>7 min</em> read</span></div></div></div><div class="post-content"><h2 id="whats-the-need"><span class="me-2">What’s the need?</span><a href="#whats-the-need" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>A good subdomain enumeration will help you find those hidden/untouched subdomains, resulting lesser people finding bugs on that particular domain. Hence lesser <strong>duplicates</strong>.<li>Finding applications running on hidden, forgotten(by the organization) sub-domains may lead to uncovering critical vulnerabilities.<li>For large organizations, to find what services have they exposed to the internet while performing an internal pentest.<li>The methodology of collecting subdomains from tools like <code class="language-plaintext highlighter-rouge">amass</code>, <code class="language-plaintext highlighter-rouge">subfinder</code>, <code class="language-plaintext highlighter-rouge">findomain</code> and directly sending them to httpx/httprobe is <strong>absolutely wrong</strong>. Instead, you should first DNS resolve them using tools like <a href="https://github.com/d3mondev/puredns">puredns</a> or <a href="https://github.com/projectdiscovery/shuffledns">shuffledns</a>.</ul><aside> 💡 There are many tools that you may think it is better than the mentioned ones in some techniques, In this methodology I focus on the Techniques Themselves, You can go ahead and try your preferred Tools</aside><p><strong>From the This image you can get the idea of horizontal/Vrtical domain correlation:</strong></p><p><a href="https://h0tak88r.github.io\assets\Deep-Subdomains-Enumeration-Methodology 4b5c3da2008f4bd8b482a401314a0dcd/Untitled.png" class="popup img-link "><img data-src="https://h0tak88r.github.io\assets\Deep-Subdomains-Enumeration-Methodology 4b5c3da2008f4bd8b482a401314a0dcd/Untitled.png" alt="Untitled" class="lazyload" data-proofer-ignore></a></p><h1 id="horizontal-enumeration"><strong>Horizontal Enumeration</strong></h1><h3 id="discovering-the-ip-space"><span class="me-2">Discovering the IP space</span><a href="#discovering-the-ip-space" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>First We need to get the <strong>ASN</strong> from websites like <a href="https://bgp.he.net/">https://bgp.he.net/</a> or you can use any other tool that gets the job done</ol><blockquote><p><strong>ASN</strong>(Autonomous System Number) is a unique identifier for a set of IP-ranges an organizations owns. Very large organizations such as Apple, GitHub, Tesla have their own significant IP space.</p></blockquote><ol><li>find out the IP ranges that reside inside that ASN. For this, we will use a tool called <strong>whois.</strong></ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> apt-get <span class="nb">install </span>whois
 whois <span class="nt">-h</span> whois.radb.net  <span class="nt">--</span> <span class="s1">'-i origin AS8983'</span> | <span class="nb">grep</span> <span class="nt">-Eo</span> <span class="s2">"([0-9.]+){4}/[0-9]+"</span> | <span class="nb">uniq</span> <span class="nt">-u</span> <span class="o">&gt;</span> ip_ranges.txt
</pre></table></code></div></div><h3 id="ptr-records-reverse-dns"><span class="me-2">PTR records (Reverse DNS)</span><a href="#ptr-records-reverse-dns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Since we already know the IP space of an organization we can, we can <strong>reverse query</strong> the IP addresses and find the valid domains</p><p><strong>DNS PTR records (pointer record)</strong> helps us to achieve this. We can query a <strong>PTR record</strong> of an IP address and find the associated <strong>hostname/domain name</strong>.</p><ol><li><p>Chain the tools <strong><a href="https://github.com/projectdiscovery/mapcidr">Mapcidr</a> - <a href="https://github.com/projectdiscovery/dnsx">Dnsx</a></strong> together in one liner</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> <span class="nb">cat </span>ip_anges.txt | mapcidr <span class="nt">-silent</span> | dnsx <span class="nt">-ptr</span> <span class="nt">-resp-only</span> <span class="nt">-o</span> ptr_recrds.txt
</pre></table></code></div></div></ol><blockquote><p>When an IP range is given to <code class="language-plaintext highlighter-rouge">mapcidr</code> through stdin(standard input), it performs <strong>expansion of the CIDR range</strong>, spitting out each <strong>IP address</strong> from the range onto a new line. Now when <strong><code class="language-plaintext highlighter-rouge">dnsx</code></strong> receives each IP address from stdin, it performs <strong>reverse DNS</strong> and checks for <strong>PTR record</strong>. If, found it gives us back the <strong>hostname/domain name</strong>.</p></blockquote><h3 id="favicon-search"><span class="me-2"><strong>Favicon Search</strong></span><a href="#favicon-search" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p><strong>What is a favicon?</strong> The image/icon shown on the left-hand side of a tab is called as <strong>favicon.ico</strong></p></blockquote><p><a href="https://h0tak88r.github.io\assets\Deep-Subdomains-Enumeration-Methodology 4b5c3da2008f4bd8b482a401314a0dcd/Untitled%201.png" class="popup img-link "><img data-src="https://h0tak88r.github.io\assets\Deep-Subdomains-Enumeration-Methodology 4b5c3da2008f4bd8b482a401314a0dcd/Untitled%201.png" alt="Untitled" class="lazyload" data-proofer-ignore></a></p><ol><li>View source of the websitepage<li>Search for favicon.ico<li>download it from the link you got from source code<li><p>Calculate the hash using python3</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre> <span class="kn">import</span> <span class="n">hashlib</span>
    
 <span class="k">def</span> <span class="nf">calculate_favicon_hash</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
     <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
         <span class="n">favicon_data</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
         <span class="n">favicon_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">md5</span><span class="p">(</span><span class="n">favicon_data</span><span class="p">).</span><span class="nf">hexdigest</span><span class="p">()</span>
     <span class="k">return</span> <span class="n">favicon_hash</span>
    
 <span class="n">favicon_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">/path/to/favicon.ico</span><span class="sh">'</span>
 <span class="n">favicon_hash</span> <span class="o">=</span> <span class="nf">calculate_favicon_hash</span><span class="p">(</span><span class="n">favicon_path</span><span class="p">)</span>
 <span class="nf">print</span><span class="p">(</span><span class="n">favicon_hash</span><span class="p">)</span>
</pre></table></code></div></div><li>Shodan Search <code class="language-plaintext highlighter-rouge">http.favicon.hash:[Favicon hash here]</code></ol><blockquote><p><strong>Hint</strong>: Generally the favicon hash of any spring boot application is <code class="language-plaintext highlighter-rouge">116323821</code><strong>.</strong> So we can use this shodan filter <em>**</em><code class="language-plaintext highlighter-rouge">http.favicon.hash:116323821</code>, You can use different favicon hashes for different services.</p></blockquote><h3 id="automation-"><span class="me-2">Automation ?</span><a href="#automation-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Use https://github.com/devanshbatham/FavFreak</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">cat </span>urls.txt | python3 favfreak.py <span class="nt">-o</span> output
http.favicon.hash:-&lt;<span class="nb">hash</span><span class="o">&gt;</span>
</pre></table></code></div></div><h1 id="vertical-enumeration"><strong>Vertical Enumeration</strong></h1><h2 id="passive-enum"><span class="me-2">Passive Enum</span><a href="#passive-enum" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>Here you got alot of tools that do the job but it is not about the tools you use it is about the technoque or the way you do it .You Must use the tool with all of api’s you can get</p></blockquote><p>Personally I prefer <code class="language-plaintext highlighter-rouge">subfinder</code></p><p><strong>Subfinder</strong> [ <code class="language-plaintext highlighter-rouge">subfinder -d test.com -o passive2.txt -all</code> ]</p><p>Here is a list of free-api websites</p><ol><li>censys<li>bevigil<li>binaryedge<li>cerspotter<li><p>whoisxmlapi</p><li>fofa<li>shodan<li>github<li>virustotal<li>zoomeye<ul><li>There are in total around <strong><a href="https://gist.github.com/sidxparab/22c54fd0b64492b6ae3224db8c706228">90 passive DNS sources/services</a></strong> that provide such datasets to query them<li>You can use another tool that use free services and apis to do subdomain enumeration <a href="https://github.com/sl4x0/subfree">https://github.com/sl4x0/subfree</a><li><a href="https://dnsdumpster.com/">https://dnsdumpster.com/</a> → FREE domain research tool that can discover hosts related to a domain. Finding visible hosts from the attackers perspective is an important part of the security assessment process.<li><a href="https://chaos.projectdiscovery.io/#/">https://chaos.projectdiscovery.io/#/</a> → → it is like database or somthng here u can get all subdomains for public bug bounty programs , Yeah it is useless when you work in a private ones</ul></ol><h3 id="another-ways-i-dont-use-"><span class="me-2">Another Ways (I don’t use )</span><a href="#another-ways-i-dont-use-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Internet Archive →</strong> <a href="https://github.com/lc/gau">district →</a> <a href="https://github.com/tomnomnom/waybackurls">waybackurls</a><li><strong>Github Scraping →</strong> <a href="https://github.com/gwen001/github-subdomains">github-subdomains</a><li><strong>GitLab Scraping →</strong> <a href="https://github.com/gwen001/gitlab-subdomains">gitlab-subdomains</a></ul><h3 id="recursive-enumeration"><span class="me-2"><strong>Recursive Enumeration</strong></span><a href="#recursive-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>In easy words, we again run tools like Amass, Subfinder, Assetfinder again each of the subdomains that were found.<li>If you have set up API keys, this technique may consume your entire querying quota<li>This technique is only useful when your target has a large number of multi-level subdomains<em>(not effective for small &amp; medium scope targets).</em><li>It is a huge use of resources and power and takes time to return the final results so be careful and make this technique the last step of you process if you can :)))<li>Do it exclusively on a validated list of subdomains that you have collected through other <strong>Passive + Active</strong> techniques.</ul><p><strong>Workflow:</strong></p><ol><li>Read the list of subdomains from the file “subdomains.txt”.<li>Process the subdomains in two steps: <strong>a)</strong> Find the Top-10 most frequent occuring <strong>Second-Level Domain</strong> names with the help of tools like <code class="language-plaintext highlighter-rouge">cut</code>, <code class="language-plaintext highlighter-rouge">sort</code>, <code class="language-plaintext highlighter-rouge">rev</code>, <code class="language-plaintext highlighter-rouge">uniq</code> <strong>b)</strong> Find the Top-10 most frequent occuring <strong>Third-Level domains</strong>.<li>Now run passive subdomain enumeration on these 10 Second-level domain names and 10 Third-level domain names using tools like <strong>amass, subfinder, assetfinder, findomain.</strong><li>Keep appending the results to <code class="language-plaintext highlighter-rouge">passive_recursive.txt</code> file.<li>Now after finding out the a list of domain names, run puredns to DNS resolve them and find the alive subdomains</ol><h3 id="automation"><span class="me-2">Automation</span><a href="#automation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

go <span class="nb">install</span> <span class="nt">-v</span> github.com/tomnomnom/anew@latest
<span class="nv">subdomain_list</span><span class="o">=</span><span class="s2">"subdomains.txt"</span>

<span class="k">for </span>sub <span class="k">in</span> <span class="si">$(</span> <span class="o">(</span> <span class="nb">cat</span> <span class="nv">$subdomain_list</span> | rev | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">'.'</span> <span class="nt">-f</span> 3,2,1 | rev | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span> | <span class="nb">sort</span> <span class="nt">-nr</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'1 '</span> | <span class="nb">head</span> <span class="nt">-n</span> 10 <span class="o">&amp;&amp;</span> <span class="nb">cat </span>subdomains.txt | rev | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">'.'</span> <span class="nt">-f</span> 4,3,2,1 | rev | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span> | <span class="nb">sort</span> <span class="nt">-nr</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'1 '</span> | <span class="nb">head</span> <span class="nt">-n</span> 10 <span class="o">)</span> | <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'s/^[[:space:]]*//'</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f</span> 2<span class="si">)</span><span class="p">;</span><span class="k">do 
    </span>subfinder <span class="nt">-d</span> <span class="nv">$sub</span> <span class="nt">-silent</span> <span class="nt">-max-time</span> 2 | anew <span class="nt">-q</span> passive_recursive.txt
    assetfinder <span class="nt">--subs-only</span> <span class="nv">$sub</span> | anew <span class="nt">-q</span> passive_recursive.txt
    amass enum <span class="nt">-timeout</span> 2 <span class="nt">-passive</span> <span class="nt">-d</span> <span class="nv">$sub</span> | anew <span class="nt">-q</span> passive_recursive.txt
    findomain <span class="nt">--quiet</span> <span class="nt">-t</span> <span class="nv">$sub</span> | anew <span class="nt">-q</span> passive_recursive.txt
<span class="k">done</span>
</pre></table></code></div></div><h2 id="active-enum"><span class="me-2">Active Enum</span><a href="#active-enum" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul class="task-list"><li class="task-list-item"><p><i class="far fa-circle fa-fw"></i><strong>DNS Brute Forcing</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>  <span class="c">#Prerequisites</span>
  git clone https://github.com/blechschmidt/massdns.git
  <span class="nb">cd </span>massdns
  make
  <span class="nb">sudo </span>make <span class="nb">install</span>
    
  <span class="c">#Installing the tool</span>
  go <span class="nb">install </span>github.com/d3mondev/puredns/v2@latest
    
  <span class="c"># Download Resolvers List</span>
  wget https://github.com/trickest/resolvers/blob/main/resolvers-trusted.txt
  wget https://public-dns.info/nameservers.txt
  <span class="c"># Download dns wordlist  </span>
  wget https://wordlists-cdn.assetnote.io/data/manual/best-dns-wordlist.txt
    
  <span class="c"># Brute Forcing</span>
  puredns bruteforce dns_bf_wordlist.txt example.com <span class="nt">-r</span> resolvers.txt <span class="nt">-w</span> dns_bf.txt
  or
  amass enum <span class="nt">-brute</span> wordlist.txt <span class="nt">-d</span> target.com <span class="nt">-o</span> dns_bf.txt
  or
  shuffledns <span class="nt">-d</span> target.com <span class="nt">-list</span> wordlist.txt <span class="nt">-r</span> resolvers.txt <span class="nt">-o</span> dns_bf.txt
</pre></table></code></div></div><li class="task-list-item"><p><i class="far fa-circle fa-fw"></i><strong>Permutations</strong></p></ul><ol><li>generate various combinations or permutations of a root domain<li>DNS resolve them and check if we get any valid subdomains<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre> <span class="c"># Permutation words Wordlist</span>
 wget https://gist.githubusercontent.com/six2dez/ffc2b14d283e8f8eff6ac83e20a3c4b4/raw
 <span class="c"># Run </span>
 gotator <span class="nt">-sub</span> subdomains.txt <span class="nt">-perm</span> dns_permutations_list.txt <span class="nt">-depth</span> 1 <span class="nt">-numbers</span> 10 <span class="nt">-mindup</span> <span class="nt">-adv</span> <span class="nt">-md</span> | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> perms.txt
 <span class="c"># DNS resolve them and check for valid ones.</span>
 puredns resolve permutations.txt <span class="nt">-r</span> resolvers.txt <span class="o">&gt;</span> resolved_perms
</pre></table></code></div></div></ol><ul class="task-list"><li class="task-list-item"><p><i class="far fa-circle fa-fw"></i><strong>Google analytics</strong></p><li class="task-list-item">Most organizations use Google Analytics to track website visitors and for more statistics. Generally, they have the same Google Analytics ID across all subdomains of a root domain. This means we can perform a reverse search and find all the subdomains having the same ID. Hence, it helps us in the enumeration process.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="o">&gt;</span> git clone https://github.com/Josue87/AnalyticsRelationships.git
  <span class="o">&gt;</span> <span class="nb">cd </span>AnalyticsRelationships/Python
  <span class="o">&gt;</span> <span class="nb">sudo </span>pip3 <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
  python3 analyticsrelationships.py <span class="nt">-u</span> https://www.example.com
</pre></table></code></div></div><li class="task-list-item"><i class="far fa-circle fa-fw"></i><strong>TLS, CSP, CNAME Probing</strong><li class="task-list-item">In order to use HTTPS, the website owner needs to issue an SSL(Secure Socket Layer) certificate.<li class="task-list-item"><p>CSP headers sometimes contain <strong>domains/subdomains</strong> from where the content is usually imported</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>  go <span class="nb">install </span>github.com/glebarez/cero@latest
  <span class="c">#tls</span>
  cero <span class="k">in</span>.search.yahoo.com | <span class="nb">sed</span> <span class="s1">'s/^*.//'</span> | <span class="nb">grep</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\.</span><span class="s2">"</span> | <span class="nb">sort</span> <span class="nt">-u</span>
  <span class="c">#cls</span>
  <span class="nb">cat </span>subdomains.txt | httpx <span class="nt">-csp-probe</span> <span class="nt">-status-code</span> <span class="nt">-retries</span> 2 <span class="nt">-no-color</span> | anew csp_probed.txt | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f1</span> | unfurl <span class="nt">-u</span> domains | anew <span class="nt">-q</span> csp_subdomains.txt
  <span class="c"># cname</span>
  dnsx <span class="nt">-retry</span> 3 <span class="nt">-cname</span> <span class="nt">-l</span> subdomains.txt
</pre></table></code></div></div></ul><h1 id="finish-work">Finish Work</h1><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nb">cd </span>subs/
<span class="nb">cat </span>horizontal/ptr_records.txt | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> horizontal.txt
<span class="nb">cat </span>Vertical/Active/<span class="k">*</span> | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> active.txt
<span class="nb">cat </span>Vertical/Pssive/<span class="k">*</span> | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> passive.txt
<span class="nb">cat</span> <span class="k">*</span> | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> all_subs.txt
<span class="nb">cat </span>all_subs.txt | httpx <span class="nt">-random-agent</span> <span class="nt">-retries</span> 2 <span class="nt">-no-color</span> <span class="nt">-o</span> filtered_subs.txt
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/recon/'>Recon</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/recon/" class="post-tag no-text-decoration" >Recon</a> <a href="/tags/subdomain-enumeration/" class="post-tag no-text-decoration" >Subdomain_Enumeration</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Deep-Subdomains-Enumeration%20-%20hotak88r&url=h0tak88r.github.com%2Fposts%2FDeep-Subdomains-Enumeration%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Deep-Subdomains-Enumeration%20-%20hotak88r&u=h0tak88r.github.com%2Fposts%2FDeep-Subdomains-Enumeration%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=h0tak88r.github.com%2Fposts%2FDeep-Subdomains-Enumeration%2F&text=Deep-Subdomains-Enumeration%20-%20hotak88r" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/recon/">Recon</a> <a class="post-tag btn btn-outline-primary" href="/tags/subdomain-enumeration/">Subdomain_Enumeration</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div class="post-navigation d-flex justify-content-between"><div class="btn btn-outline-primary disabled" prompt="Older" ><p>-</p></div><div class="btn btn-outline-primary disabled" prompt="Newer" ><p>-</p></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/recon/">Recon</a> <a class="post-tag btn btn-outline-primary" href="/tags/subdomain-enumeration/">Subdomain_Enumeration</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a></p><p>© 2023 <a href="https://twitter.com/h0tak88r">Mosaad Sallam</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
